#!/bin/bash
# Automated development session launcher
# Usage: dev-session <project-type> <project-name>

PROJECT_TYPE="$1"
PROJECT_NAME="$2"

if [ -z "$PROJECT_TYPE" ]; then
    echo "Usage: dev-session <rust|python|r|forestry> <project-name>"
    exit 1
fi

case "$PROJECT_TYPE" in
    rust)
        if [ -z "$PROJECT_NAME" ]; then
            echo "Error: Please specify project name"
            exit 1
        fi
        PROJECT_PATH="$HOME/rust-projects/$PROJECT_NAME"
        if [ ! -d "$PROJECT_PATH" ]; then
            echo "Error: Project not found: $PROJECT_PATH"
            exit 1
        fi
        cd "$PROJECT_PATH" || exit
        # Launch VSCode and terminal
        swaymsg "workspace 3; exec code-oss '$PROJECT_PATH'" &
        sleep 1
        swaymsg "workspace 4; exec kitty --directory '$PROJECT_PATH'" &
        notify-send "Dev Session: Rust" "Project: $PROJECT_NAME"
        ;;

    python)
        if [ -z "$PROJECT_NAME" ]; then
            echo "Error: Please specify project name"
            exit 1
        fi
        PROJECT_PATH="$HOME/python-projects/$PROJECT_NAME"
        if [ ! -d "$PROJECT_PATH" ]; then
            echo "Error: Project not found: $PROJECT_PATH"
            exit 1
        fi
        cd "$PROJECT_PATH" || exit
        # Activate venv if exists
        if [ -f ".venv/bin/activate" ]; then
            source .venv/bin/activate
        fi
        # Launch VSCode and terminal
        swaymsg "workspace 3; exec code-oss '$PROJECT_PATH'" &
        sleep 1
        swaymsg "workspace 4; exec kitty --directory '$PROJECT_PATH'" &
        notify-send "Dev Session: Python" "Project: $PROJECT_NAME"
        ;;

    r)
        if [ -z "$PROJECT_NAME" ]; then
            # Launch general R environment
            workflow-launch r-analysis
        else
            PROJECT_PATH="$HOME/r-projects/$PROJECT_NAME"
            if [ ! -d "$PROJECT_PATH" ]; then
                echo "Error: Project not found: $PROJECT_PATH"
                exit 1
            fi
            cd "$PROJECT_PATH" || exit
            swaymsg "workspace 2; exec rstudio '$PROJECT_PATH'" &
            sleep 1
            swaymsg 'workspace 1; exec obsidian' &
            notify-send "Dev Session: R" "Project: $PROJECT_NAME"
        fi
        ;;

    forestry)
        # Launch forestry coursework environment
        VAULT_PATH="$HOME/University of Idaho"
        cd "$VAULT_PATH" || exit
        swaymsg 'workspace 1; exec obsidian' &
        sleep 1
        swaymsg 'workspace 2; exec rstudio' &
        sleep 0.5
        swaymsg "workspace 4; exec kitty --directory '$VAULT_PATH'" &
        notify-send "Dev Session: Forestry" "Full coursework environment"
        ;;

    *)
        echo "Usage: dev-session <rust|python|r|forestry> <project-name>"
        echo ""
        echo "Examples:"
        echo "  dev-session rust my-project"
        echo "  dev-session python data-analysis"
        echo "  dev-session r"
        echo "  dev-session forestry"
        exit 1
        ;;
esac
